{% extends "base.html" %}
{% load static %}

{% block title %}Mis Reservas{% endblock %}

{% block content %}
<div class="container py-5">
  <h2 class="text-center mb-5 text-info fw-bold">
    <i class="fa-solid fa-calendar-days me-2"></i>Mis Reservas
  </h2>

  {% if reservas %}
  <div class="row justify-content-center g-4">
    {% for r in reservas %}
    <div class="col-md-4 d-flex align-items-stretch">
      <div class="card shadow-sm w-100 text-center
           {% if r.estado == 'Activa' %} border-success
           {% elif r.estado == 'Cancelada' %} border-danger
           {% else %} border-warning{% endif %}"
           style="background-color: var(--color-bg-secondary); transition: 0.3s;">
        
        {% if r.id_espacio.imagen %}
        <img src="{{ r.id_espacio.imagen.url }}" class="card-img-top"
             style="height: 180px; object-fit: cover; border-bottom: 1px solid var(--color-border);">
        {% endif %}

        <div class="card-body text-white">
          <h5 class="card-title text-info">{{ r.id_espacio.nombre }}</h5>
          <p class="mb-1"><i class="fa-solid fa-calendar-day me-1"></i> {{ r.fecha|date:"d/m/Y" }}</p>
          <p class="mb-1"><i class="fa-solid fa-clock me-1"></i> {{ r.hora_inicio|time:"H:i" }} â€“ {{ r.hora_fin|time:"H:i" }}</p>
          <p class="mb-1"><i class="fa-solid fa-dollar-sign me-1"></i> ${{ r.total|floatformat:0 }}</p>

          <div class="mt-3">
            <span class="badge 
              {% if r.estado == 'Activa' %}bg-success
              {% elif r.estado == 'Cancelada' %}bg-danger
              {% else %}bg-warning text-dark{% endif %}">
              {{ r.estado }}
            </span>
          </div>
        </div>

        <div class="card-footer border-top">
          Creada: {{ r.fecha_creacion|date:"d/m/Y H:i" }}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  {% else %}
  <div class="text-center text-muted mt-5">
    <i class="fa-regular fa-calendar-xmark fa-3x mb-3"></i>
    <p>No tienes reservas registradas.</p>
    <a href="{% url 'ver_espacios_comunales' %}" class="btn btn-outline-info">
      <i class="fa-solid fa-door-open me-1"></i> Ver espacios disponibles
    </a>
  </div>
  {% endif %}
</div>
{% endblock %}
