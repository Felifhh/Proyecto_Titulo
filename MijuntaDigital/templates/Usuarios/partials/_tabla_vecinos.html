{% load static %}
<div class="table-responsive" style="max-height: 500px; overflow-y: auto;">
  <table class="table table-striped table-hover align-middle text-center table-dark">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nombre</th>
        <th>RUN</th>
        <th>Correo</th>
        <th>Estado</th>
        <th>Rol</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for v in vecinos %}
      <tr>
        <td>
          {% if v.foto and v.foto.name %}
            <img src="{{ v.foto.url }}" class="rounded-circle" width="50" height="50" style="object-fit: cover;">
          {% else %}
            <img src="{% static 'img/user-placeholder.png' %}" class="rounded-circle" width="50" height="50">
          {% endif %}
        </td>
        <td>{{ v.nombre }}</td>
        <td>{{ v.run }}</td>
        <td>{{ v.correo }}</td>
        <td>
          {% if v.estado == "Activo" %}
            <span class="badge bg-success">Activo</span>
          {% elif v.estado == "Desactivado" %}
            <span class="badge bg-secondary">Desactivado</span>
          {% elif v.estado == "Rechazado" %}
            <span class="badge bg-danger">Rechazado</span>
          {% endif %}
        </td>

        <td>
          {% if estado_tab == "Activo" %}
            <form method="post" action="{% url 'cambiar_rol' v.id_vecino %}">
              {% csrf_token %}
              <select name="rol_id" class="form-select form-select-sm">
                {% for rol in roles %}
                  <option value="{{ rol.id_rol }}" {% if rol.id_rol == v.id_rol.id_rol %}selected{% endif %}>
                    {{ rol.nombre }}
                  </option>
                {% endfor %}
              </select>
              <button type="submit" class="btn btn-sm btn-outline-primary mt-1">Cambiar</button>
            </form>
          {% else %}
            <span>No modificable</span>
          {% endif %}
        </td>

        <td>
          {% if v.estado == "Activo" %}
            <a href="{% url 'desactivar_vecino' v.id_vecino %}" class="btn btn-sm btn-danger">Desactivar</a>
          {% elif v.estado == "Desactivado" or v.estado == "Rechazado" %}
            <a href="{% url 'activar_vecino' v.id_vecino %}" class="btn btn-sm btn-success">Activar</a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="7" class="text-center">No hay vecinos en esta categor√≠a.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

