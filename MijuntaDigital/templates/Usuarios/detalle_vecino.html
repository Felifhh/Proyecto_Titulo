{% extends "base.html" %}
{% block title %}Detalle de Vecino{% endblock %}
{% load static %}

{% block content %}
<!-- MENSAJES FLASH -->
{% if messages %}
<div class="container mt-4 d-flex justify-content-center">
  <div class="col-md-8">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm text-center position-relative"
      role="alert">
      <i class="fa-solid fa-circle-info me-2"></i> {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
      <div class="alert-progress"></div>
    </div>
    {% endfor %}
  </div>
</div>
<script src="{% static 'js/mensaje.js' %}"></script>
{% endif %}

<div class="container py-5" style="border: 0cap;">

  <div class="card shadow-lg p-5" style="background-color: var(--color-bg-secondary); border: 0;">

    <h2 class="text-center mb-4 fw-bold" style="color: var(--color-primary);">
      <i class="fa-solid fa-id-card me-2"></i>
      Detalle del Registro del Vecino
    </h2>

    <div class="row g-4">

      <!-- INFORMACIÓN DEL VECINO -->
      <div class="col-md-8 mx-auto">

        <div class="table-responsive">
          <table class="table table-dark table-striped align-middle text-center">

            <tbody>
              <tr>
                <th class="fw-bold text-secondary text-white">RUN:</th>
                <td>{{ vecino.run }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Nombre:</th>
                <td>{{ vecino.nombre }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Dirección:</th>
                <td>{{ vecino.direccion }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Correo:</th>
                <td>{{ vecino.correo }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Teléfono:</th>
                <td>{{ vecino.telefono }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Fecha de registro:</th>
                <td>{{ vecino.fecha_registro|date:"d/m/Y H:i" }}</td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Estado actual:</th>
                <td>
                  {% if vecino.estado == "Pendiente" %}
                    <span class="badge bg-warning text-dark px-3 py-2">{{ vecino.estado }}</span>
                  {% elif vecino.estado == "Activo" %}
                    <span class="badge bg-success px-3 py-2">{{ vecino.estado }}</span>
                  {% elif vecino.estado == "Rechazado" %}
                    <span class="badge bg-danger px-3 py-2">{{ vecino.estado }}</span>
                  {% else %}
                    <span class="badge bg-secondary px-3 py-2">{{ vecino.estado }}</span>
                  {% endif %}
                </td>
              </tr>

              <tr>
                <th class="fw-bold text-secondary text-white">Evidencia:</th>
                <td>
                  {% if vecino.evidencia %}
                    <a href="{{ vecino.evidencia.url }}" target="_blank" 
                       class="btn btn-outline-info btn-sm">
                      <i class="fa-solid fa-file-arrow-down me-1"></i> Ver Documento
                    </a>
                  {% else %}
                    <span>No se adjuntó evidencia.</span>
                  {% endif %}
                </td>
              </tr>

            </tbody>
          </table>
        </div>
      </div>

    </div>

    <hr class="border-secondary my-4">

    <!-- ACCIONES -->
    <div class="text-center mt-4">

      <form method="post" action="{% url 'usuarios_aprobar' vecino.id_vecino %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-success px-4 py-2 shadow-sm">
          <i class="fa-solid fa-check me-1"></i> Aprobar
        </button>
      </form>

      <form method="post" action="{% url 'usuarios_rechazar' vecino.id_vecino %}" class="d-inline ms-2">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger px-4 py-2 shadow-sm">
          <i class="fa-solid fa-xmark me-1"></i> Rechazar
        </button>
      </form>

      <a href="{% url 'usuarios_pendientes' %}" class="btn btn-outline-light ms-3 px-4 py-2">
        <i class="fa-solid fa-arrow-left me-1"></i> Volver
      </a>
    </div>

  </div>

</div>
{% endblock %}
